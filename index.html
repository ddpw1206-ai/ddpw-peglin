<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ddpw - Peglin Random Picker</title>
  <link rel="stylesheet" href="style.css">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Noto Sans KR", sans-serif !important;
      background-color: #071020 !important;
      color: #f5f0e6 !important;
      padding: 0 !important;
      min-height: 100vh !important;
      line-height: 1.6 !important;
      margin: 0 !important;
      display: block !important;
      align-items: normal !important;
      justify-content: normal !important;
    }

    .header {
      background: 
        radial-gradient(circle at 20% 50%, rgba(138, 203, 90, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 50%, rgba(255, 152, 0, 0.15) 0%, transparent 50%),
        linear-gradient(135deg, #6b3b26 0%, #4b2616 50%, #3d1f0f 100%);
      color: #fbe7c5;
      padding: 40px 20px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 4px solid #8b4513;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: 
        repeating-linear-gradient(
          45deg,
          transparent,
          transparent 10px,
          rgba(139, 203, 90, 0.03) 10px,
          rgba(139, 203, 90, 0.03) 20px
        );
      animation: slide 20s linear infinite;
    }

    @keyframes slide {
      0% { transform: translate(0, 0); }
      100% { transform: translate(20px, 20px); }
    }

    .header-title {
      font-size: 36px;
      font-weight: 900;
      letter-spacing: 0.12em;
      text-shadow: 
        0 3px 6px rgba(0, 0, 0, 0.7),
        0 0 15px rgba(251, 231, 197, 0.4),
        3px 3px 0 rgba(107, 59, 38, 0.9),
        -1px -1px 0 rgba(251, 231, 197, 0.2);
      margin: 0;
      font-family: 'Comic Sans MS', 'ë§‘ì€ ê³ ë”•', 'Malgun Gothic', 'ë‚˜ëˆ”ê³ ë”•', cursive;
      color: #fbe7c5;
      position: relative;
      display: inline-block;
      transform: perspective(500px) rotateX(2deg);
      transition: transform 0.3s ease;
    }

    .header-title:hover {
      transform: perspective(500px) rotateX(0deg) scale(1.05);
    }

    .header-title::before {
      content: 'ğŸ¯';
      margin-right: 12px;
      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.6));
      display: inline-block;
      animation: bounce 2s ease-in-out infinite;
    }

    .header-title::after {
      content: 'ğŸ¯';
      margin-left: 12px;
      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.6));
      display: inline-block;
      animation: bounce 2s ease-in-out infinite 0.5s;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-5px) rotate(10deg); }
    }

    .main-content {
      padding: 20px;
    }

    .main-wrapper {
      display: flex;
      gap: 20px;
      max-width: 1600px;
      margin: 0 auto;
      align-items: flex-start;
    }

    .left-panel {
      flex: 0 0 320px;
      background: #f0d4a3;
      border-radius: 18px;
      box-shadow: 0 18px 0 #6b3b26, 0 26px 40px rgba(0, 0, 0, 0.7);
      padding: 20px;
      position: sticky;
      top: 120px;
      max-height: calc(100vh - 140px);
      overflow-y: auto;
    }

    .container {
      flex: 1;
      max-width: 800px;
      background: #f0d4a3;
      border-radius: 18px;
      box-shadow: 0 18px 0 #6b3b26, 0 26px 40px rgba(0, 0, 0, 0.7);
      padding: 24px 28px;
      overflow: visible;
    }

    h1 {
      font-size: 32px;
      font-weight: 900;
      letter-spacing: 0.12em;
      text-shadow: 
        0 3px 6px rgba(0, 0, 0, 0.3),
        0 0 10px rgba(75, 38, 22, 0.2),
        2px 2px 0 rgba(75, 38, 22, 0.5),
        -1px -1px 0 rgba(251, 231, 197, 0.3);
      margin-bottom: 24px;
      text-align: center;
      font-family: 'Comic Sans MS', 'ë§‘ì€ ê³ ë”•', 'Malgun Gothic', 'ë‚˜ëˆ”ê³ ë”•', cursive;
      color: #4b2616;
      position: relative;
      display: inline-block;
      width: 100%;
    }

    .title-section {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      margin-bottom: 24px;
      min-height: 80px;
    }

    .title-left {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      text-align: center;
    }

    .title-right {
      position: absolute;
      right: 0;
      top: 0;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
      margin-top: 8px;
    }

    .version-info {
      font-size: 14px;
      color: #7b4b27;
      font-weight: 600;
      font-family: 'Comic Sans MS', 'ë§‘ì€ ê³ ë”•', 'Malgun Gothic', 'ë‚˜ëˆ”ê³ ë”•', cursive;
    }

    .reset-all-btn {
      background: #ff6b6b;
      color: #4b2616;
      border: 2px solid #d63031;
      border-radius: 8px;
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 0 #d63031;
      transition: all 0.2s;
      font-family: 'Comic Sans MS', 'ë§‘ì€ ê³ ë”•', 'Malgun Gothic', 'ë‚˜ëˆ”ê³ ë”•', cursive;
    }

    .reset-all-btn:hover {
      background: #ff7979;
      transform: translateY(1px);
      box-shadow: 0 1px 0 #d63031;
    }

    .reset-all-btn:active {
      transform: translateY(2px);
      box-shadow: 0 0 0 #d63031;
    }

    h2 {
      font-size: 18px;
      color: #4b2616;
      margin-top: 20px;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 2px solid #c28b4d;
    }

    fieldset {
      background: #f5e4c4;
      border: 2px solid #c9a26a;
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 20px;
      box-shadow: 0 3px 0 #c09357;
    }

    legend {
      color: #4b2616;
      font-weight: 600;
      padding: 0 8px;
      font-size: 14px;
    }

    label {
      display: block;
      margin: 8px 0 4px 0;
      color: #4b2616;
      font-size: 14px;
    }

    input[type="number"] {
      width: 80px;
      padding: 6px 8px;
      border: 2px solid #c9a26a;
      border-radius: 6px;
      background: #f5f0e6;
      color: #4b2616;
      font-size: 14px;
      margin-left: 8px;
    }

    input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: #8acb5a;
      cursor: pointer;
    }

    button {
      background: #8acb5a;
      color: #132011;
      border: 2px solid #6b8e3a;
      border-radius: 8px;
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      margin: 6px 4px 6px 0;
      box-shadow: 0 3px 0 #6b8e3a;
      transition: all 0.2s;
    }

    button:hover {
      background: #9ddb6a;
      transform: translateY(1px);
      box-shadow: 0 2px 0 #6b8e3a;
    }

    button:active {
      transform: translateY(3px);
      box-shadow: 0 0 0 #6b8e3a;
    }

    .result-box {
      background: #e7cda1;
      border: 3px solid #c28b4d;
      border-radius: 10px;
      padding: 12px;
      margin-top: 12px;
      box-shadow: inset 0 0 0 2px #f6e0ba;
      min-height: 40px;
      color: #4b2616;
    }

    .result-value {
      font-weight: bold;
      color: #d32f2f;
      font-size: 1.1em;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    .result-item {
      margin: 4px 0;
      padding: 8px 10px;
      background: #f5e4c4;
      border: 2px solid #c9a26a;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 0 #c09357;
      gap: 8px;
    }

    .result-item-content {
      flex: 1;
      color: #4b2616;
      font-size: 14px;
      line-height: 1.3;
    }

    .result-summary {
      background: #e7cda1;
      border: 2px solid #c28b4d;
      border-radius: 8px;
      padding: 8px 12px;
      margin-bottom: 12px;
      color: #4b2616;
      font-weight: 600;
      box-shadow: inset 0 0 0 1px #f6e0ba;
    }

    .rarity-text {
      color: #8b4513;
      font-weight: 700;
    }

    .redraw-btn {
      margin-left: 12px;
      padding: 6px 12px;
      font-size: 12px;
      background: #ff9800;
      color: #4b2616;
      border: 2px solid #e68900;
      box-shadow: 0 2px 0 #e68900;
      font-weight: 600;
    }

    .redraw-btn:hover {
      background: #ffa726;
      transform: translateY(1px);
      box-shadow: 0 1px 0 #e68900;
    }

    .redraw-btn:active {
      transform: translateY(2px);
      box-shadow: 0 0 0 #e68900;
    }

    .quick-draw-panel {
      background: #f5e4c4;
      border: 2px solid #c9a26a;
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 3px 0 #c09357;
    }

    .quick-draw-title {
      font-size: 16px;
      color: #4b2616;
      font-weight: 600;
      margin-bottom: 12px;
      text-align: center;
    }

    .history-box {
      background: #e7cda1;
      border: 3px solid #c28b4d;
      border-radius: 10px;
      padding: 12px;
      max-height: 400px;
      overflow-y: auto;
      box-shadow: inset 0 0 0 2px #f6e0ba;
      font-size: 13px;
    }

    .history-item {
      padding: 6px 8px;
      margin: 4px 0;
      background: #f5e4c4;
      border-radius: 6px;
      color: #4b2616;
      border-left: 3px solid #c28b4d;
    }

    .history-clear-btn {
      width: 100%;
      margin-top: 8px;
      background: #ff6b6b;
      color: #4b2616;
      border: 2px solid #d63031;
      box-shadow: 0 2px 0 #d63031;
      font-weight: 600;
    }

    .history-clear-btn:hover {
      background: #ff7979;
    }

    .left-panel::-webkit-scrollbar {
      width: 8px;
    }

    .left-panel::-webkit-scrollbar-track {
      background: #d8b783;
      border-radius: 4px;
    }

    .left-panel::-webkit-scrollbar-thumb {
      background: #b47b46;
      border-radius: 4px;
    }

    @media (max-width: 1200px) {
      .main-content {
        padding: 15px;
      }

      .main-wrapper {
        flex-direction: column;
      }

      .left-panel {
        flex: 1;
        position: relative;
        top: 0;
        max-height: none;
      }

      .header-title {
        font-size: 28px;
      }
    }

    @media (max-width: 768px) {
      .header {
        padding: 25px 15px;
      }

      .header-title {
        font-size: 22px;
        letter-spacing: 0.08em;
      }

      .header-title::before,
      .header-title::after {
        font-size: 0.8em;
      }

      .title-section {
        flex-direction: column;
        align-items: center;
        min-height: auto;
      }

      .title-left {
        position: relative;
        left: auto;
        transform: none;
        width: 100%;
      }

      .title-right {
        position: relative;
        right: auto;
        top: auto;
        align-items: center;
        width: 100%;
        margin-top: 12px;
      }

      h1 {
        font-size: 24px;
        letter-spacing: 0.08em;
      }

      .version-info {
        font-size: 12px;
      }

      .reset-all-btn {
        width: 100%;
        max-width: 200px;
      }
    }

    @media (max-width: 768px) {
      .container, .left-panel {
        padding: 16px;
        margin: 10px;
      }

      h1 {
        font-size: 22px;
      }

      h2 {
        font-size: 16px;
      }

      fieldset {
        padding: 12px;
      }

      button {
        width: 100%;
        margin: 4px 0;
      }

      .result-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }

      .redraw-btn {
        margin-left: 0;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-title">ddpw's Peglin Random Picker</div>
  </div>
  <div class="main-content">
    <div class="main-wrapper">
    <!-- ì™¼ìª½: ìƒì‹œ ëœë¤ ë½‘ê¸° ë„êµ¬ -->
    <div class="left-panel">
      <div class="quick-draw-panel">
        <div class="quick-draw-title">âš¡ ë¹ ë¥¸ ëœë¤ ë½‘ê¸°</div>
        <label>
          ìµœëŒ€ ë²ˆí˜¸:
          <input type="number" id="quickMaxNumber" value="10" min="1" max="999" />
        </label>
        <button onclick="quickRandomDraw()" style="width: 100%; margin-top: 8px;">
          ëœë¤ ë½‘ê¸° (1 ~ ìµœëŒ€)
        </button>
        <div id="quickResult" class="result-box" style="margin-top: 12px; min-height: 50px; text-align: center; font-size: 24px; font-weight: bold; color: #d32f2f;">
          -
        </div>
      </div>

      <div class="quick-draw-panel">
        <div class="quick-draw-title">ğŸ“œ ë½‘ê¸° íˆìŠ¤í† ë¦¬</div>
        <div id="historyBox" class="history-box">
          <div style="color: #7b4b27; text-align: center; padding: 20px;">ì•„ì§ ë½‘ê¸° ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>
        </div>
        <button class="history-clear-btn" onclick="clearHistory()">íˆìŠ¤í† ë¦¬ ì§€ìš°ê¸°</button>
      </div>
    </div>

    <!-- ì˜¤ë¥¸ìª½: ê¸°ì¡´ ê²Œì„ ë½‘ê¸° ê¸°ëŠ¥ -->
    <div class="container">
      <div class="title-section">
        <div class="title-left">
          <h1>ë¹ ê¸€ ë¹ ê¸€ ë¹ ê¸€ë¦°</h1>
        </div>
        <div class="title-right">
          <div class="version-info">Ver 1.0.3</div>
          <button class="reset-all-btn" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>
        </div>
      </div>

  <!-- ê³µí†µ: ëœë¤ ìœ í‹¸ -->
  <script>
    function randInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // ë¹ ë¥¸ ëœë¤ ë½‘ê¸° ê¸°ëŠ¥
    let drawHistory = [];

    function quickRandomDraw() {
      const max = parseInt(document.getElementById('quickMaxNumber').value || '1', 10);
      if (max < 1) {
        alert('ìµœëŒ€ ë²ˆí˜¸ëŠ” 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
        return;
      }
      const result = randInt(1, max);
      const resultEl = document.getElementById('quickResult');
      resultEl.innerHTML = '<span class="result-value">' + result + '</span>';
      
      // íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
      const timestamp = new Date().toLocaleTimeString('ko-KR');
      drawHistory.unshift({
        time: timestamp,
        max: max,
        result: result
      });
      
      // ìµœëŒ€ 50ê°œê¹Œì§€ë§Œ ì €ì¥
      if (drawHistory.length > 50) {
        drawHistory = drawHistory.slice(0, 50);
      }
      
      renderHistory();
    }

    function renderHistory() {
      const historyBox = document.getElementById('historyBox');
      if (drawHistory.length === 0) {
        historyBox.innerHTML = '<div style="color: #7b4b27; text-align: center; padding: 20px;">ì•„ì§ ë½‘ê¸° ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
        return;
      }
      
      let html = '';
      drawHistory.forEach((item, index) => {
        html += '<div class="history-item">';
        html += '<strong>' + item.time + '</strong> - ';
        html += '1~' + item.max + ' â†’ <span style="color: #d32f2f; font-weight: bold; font-size: 14px;">' + item.result + '</span>';
        html += '</div>';
      });
      historyBox.innerHTML = html;
    }

    function clearHistory() {
      if (confirm('íˆìŠ¤í† ë¦¬ë¥¼ ëª¨ë‘ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        drawHistory = [];
        renderHistory();
      }
    }

    // ì „ì²´ ì´ˆê¸°í™” í•¨ìˆ˜
    function resetAll() {
      if (confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ë½‘ê¸° ê²°ê³¼, íˆìŠ¤í† ë¦¬, ëª¨ë“  ì„¤ì •ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤)')) {
        // ë¹ ë¥¸ ëœë¤ ë½‘ê¸° ì´ˆê¸°í™”
        drawHistory = [];
        document.getElementById('quickResult').innerHTML = '-';
        document.getElementById('quickMaxNumber').value = '10';
        renderHistory();
        
        // ìºë¦­í„°/ë‚œì´ë„ ì´ˆê¸°í™”
        document.getElementById('characterResult').textContent = '';
        document.getElementById('difficultyResult').textContent = '';
        document.getElementById('maxDifficulty').value = '10';
        
        // êµ¬ìŠ¬ ì´ˆê¸°í™”
        beadCount = 0;
        beads = [];
        beadLevels = [];
        document.getElementById('beadCountResult').textContent = '';
        document.getElementById('beadDrawResult').textContent = '';
        document.getElementById('beadLevelResult').textContent = '';
        document.getElementById('maxBeads').value = '5';
        document.getElementById('beadAllowDuplicate').checked = true;
        
        // ìœ ë¬¼ ì´ˆê¸°í™”
        relicCount = 0;
        relics = [];
        document.getElementById('relicCountResult').textContent = '';
        document.getElementById('relicDrawResult').textContent = '';
        document.getElementById('maxRelics').value = '5';
        document.getElementById('relicNumberAllowDuplicate').checked = true;
        
        // ì‹œë“œ ì´ˆê¸°í™”
        document.getElementById('seedResult').textContent = '';
        
        alert('ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }
  </script>

  <!-- 1ë‹¨ê³„: ìºë¦­í„° / ë‚œì´ë„ -->
  <h2>1ë‹¨ê³„: ìºë¦­í„° / ë‚œì´ë„</h2>
  <fieldset>
    <legend>ìºë¦­í„° & ë‚œì´ë„ ë½‘ê¸°</legend>

    <button onclick="drawCharacter()">ìºë¦­í„° ë½‘ê¸° (1~4)</button>
    <div id="characterResult" class="result-box"></div>

    <label>
      ìµœëŒ€ ë‚œì´ë„ ìˆ«ì:
      <input type="number" id="maxDifficulty" value="10" min="1" />
    </label>
    <button onclick="drawDifficulty()">ë‚œì´ë„ ë½‘ê¸° (1 ~ ìµœëŒ€)</button>
    <div id="difficultyResult" class="result-box"></div>
  </fieldset>

  <script>
    function drawCharacter() {
      const n = randInt(1, 4);
      const resultEl = document.getElementById('characterResult');
      resultEl.innerHTML = 'ì„ íƒëœ ìºë¦­í„° ë²ˆí˜¸: <span class="result-value">' + n + '</span>';
    }
    function drawDifficulty() {
      const max = parseInt(document.getElementById('maxDifficulty').value || '1', 10);
      const n = randInt(1, max);
      const resultEl = document.getElementById('difficultyResult');
      resultEl.innerHTML = 'ì„ íƒëœ ë‚œì´ë„: <span class="result-value">' + n + '</span> / ìµœëŒ€ ' + max;
    }
  </script>

  <!-- 2ë‹¨ê³„: êµ¬ìŠ¬ ë½‘ê¸° -->
  <h2>2ë‹¨ê³„-1: êµ¬ìŠ¬ ë½‘ê¸°</h2>
  <fieldset>
    <legend>êµ¬ìŠ¬ ì„¤ì •</legend>

    <label>
      ìµœëŒ€ êµ¬ìŠ¬ ê°œìˆ˜:
      <input type="number" id="maxBeads" value="5" min="1" />
    </label>
    <button onclick="decideBeadCount()">êµ¬ìŠ¬ ê°œìˆ˜ ë½‘ê¸°</button>
    <div id="beadCountResult" class="result-box"></div>

    <label>
      êµ¬ìŠ¬ ì¤‘ë³µ í—ˆìš© (í¬ê·€ë„+ë²ˆí˜¸ ì¤‘ë³µ ê°€ëŠ¥):
      <input type="checkbox" id="beadAllowDuplicate" checked />
    </label>

    <button onclick="drawBeads()">êµ¬ìŠ¬ ë„ê°ì—ì„œ ë½‘ê¸° ì‹œì‘</button>
    <div id="beadDrawResult" class="result-box"></div>

    <button onclick="drawBeadLevels()">êµ¬ìŠ¬ ë ˆë²¨ ë½‘ê¸° (1~3)</button>
    <div id="beadLevelResult" class="result-box"></div>
  </fieldset>

  <script>
    // í¬ê·€ë„ë³„ êµ¬ìŠ¬ ê°œìˆ˜
    const beadRarityCounts = {
      1: 11, // í”í•œ
      2: 27, // ë“œë¬¸
      3: 14, // í¬ê·€
      4: 6,  // íŠ¹ìˆ˜
      5: 54  // ë‹¤ë¥¸ ì§ì—…
    };

    // í¬ê·€ë„ í…ìŠ¤íŠ¸ ë§¤í•‘
    const beadRarityNames = {
      1: 'í”í•œ êµ¬ìŠ¬',
      2: 'ë“œë¬¸ êµ¬ìŠ¬',
      3: 'í¬ê·€í•œ êµ¬ìŠ¬',
      4: 'íŠ¹ìˆ˜ êµ¬ìŠ¬',
      5: 'ë‹¤ë¥¸ ì§ì—…ì˜ êµ¬ìŠ¬'
    };

    let beadCount = 0;
    let beads = []; // {rarity, index}
    let beadLevels = [];

    function decideBeadCount() {
      const max = parseInt(document.getElementById('maxBeads').value || '1', 10);
      beadCount = randInt(1, max);
      beads = [];
      beadLevels = [];
      const resultEl = document.getElementById('beadCountResult');
      resultEl.innerHTML = 'ë½‘íŒ êµ¬ìŠ¬ ê°œìˆ˜: <span class="result-value">' + beadCount + '</span> (1~' + max + ')';
      document.getElementById('beadDrawResult').textContent = '';
      document.getElementById('beadLevelResult').textContent = '';
    }

    function drawSingleBead(allowDup) {
      // í¬ê·€ë„ 1~5 ì„ íƒ
      let rarity = randInt(1, 5);
      let total = beadRarityCounts[rarity] || 0;
      if (total <= 0) {
        // ë„ê°ì— ì•„ì§ ì—†ìŒ -> ë‹¤ì‹œ ë½‘ê¸°
        return drawSingleBead(allowDup);
      }
      let idx = randInt(1, total);

      if (!allowDup) {
        // ê°™ì€ (í¬ê·€ë„, ë²ˆí˜¸) ì¡°í•©ì´ ì´ë¯¸ ìˆìœ¼ë©´ ë‹¤ì‹œ
        const exists = beads.some(b => b.rarity === rarity && b.index === idx);
        if (exists) return drawSingleBead(allowDup);
      }
      return { rarity, index: idx };
    }

    function drawBeads() {
      if (!beadCount || beadCount <= 0) {
        alert('ë¨¼ì € êµ¬ìŠ¬ ê°œìˆ˜ë¥¼ ë½‘ì•„ì£¼ì„¸ìš”.');
        return;
      }
      const allowDup = document.getElementById('beadAllowDuplicate').checked;
      beads = [];
      for (let i = 0; i < beadCount; i++) {
        const bead = drawSingleBead(allowDup);
        beads.push(bead);
      }
      renderBeads();
    }

    // ê³µí†µ ë Œë”ë§ í•¨ìˆ˜
    function renderItems(items, resultElId, itemName, rarityNames, redrawFn) {
      const resultEl = document.getElementById(resultElId);
      if (!items.length) {
        resultEl.textContent = 'ì•„ì§ ë½‘íŒ ' + itemName + 'ì´ ì—†ìŠµë‹ˆë‹¤.';
        return;
      }
      let html = '<div class="result-summary">ì´ <span class="result-value">' + items.length + '</span>ê°œì˜ ' + itemName + '</div>';
      items.forEach((item, i) => {
        const rarityName = rarityNames[item.rarity] || 'ì•Œ ìˆ˜ ì—†ìŒ';
        html += '<div class="result-item">';
        html += '<div class="result-item-content">';
        html += '<strong>' + (i + 1) + 'ë²ˆ ' + itemName + '</strong>: ';
        html += 'í¬ê·€ë„ <span class="result-value">' + item.rarity + '</span> ';
        html += '(<span class="rarity-text">' + rarityName + '</span>), ';
        html += 'ë²ˆí˜¸ <span class="result-value">' + item.index + '</span>';
        html += '</div>';
        html += '<button class="redraw-btn" onclick="' + redrawFn + '(' + i + ')">ë‹¤ì‹œ ë½‘ê¸°</button>';
        html += '</div>';
      });
      resultEl.innerHTML = html;
    }

    function redrawSingleBead(index) {
      if (index < 0 || index >= beads.length) return;
      const allowDup = document.getElementById('beadAllowDuplicate').checked;
      const newBead = drawSingleBead(allowDup);
      beads[index] = newBead;
      renderBeads();
    }

    function renderBeads() {
      renderItems(beads, 'beadDrawResult', 'êµ¬ìŠ¬', beadRarityNames, 'redrawSingleBead');
    }


    function drawBeadLevels() {
      if (!beads.length) {
        alert('ë¨¼ì € êµ¬ìŠ¬ì„ ë½‘ì•„ì£¼ì„¸ìš”.');
        return;
      }
      beadLevels = [];
      for (let i = 0; i < beads.length; i++) {
        beadLevels.push(randInt(1, 3));
      }
      renderBeadLevels();
    }

    function redrawSingleBeadLevel(index) {
      if (index < 0 || index >= beadLevels.length) return;
      beadLevels[index] = randInt(1, 3);
      renderBeadLevels();
    }

    function renderBeadLevels() {
      if (!beadLevels.length) {
        document.getElementById('beadLevelResult').innerHTML = '';
        return;
      }
      let html = '';
      beadLevels.forEach((lv, i) => {
        html += '<div class="result-item">';
        html += '<div class="result-item-content">';
        html += '<strong>' + (i + 1) + 'ë²ˆ êµ¬ìŠ¬</strong>ì˜ ë ˆë²¨: <span class="result-value">' + lv + '</span>';
        html += '</div>';
        html += '<button class="redraw-btn" onclick="redrawSingleBeadLevel(' + i + ')">ë‹¤ì‹œ ë½‘ê¸°</button>';
        html += '</div>';
      });
      document.getElementById('beadLevelResult').innerHTML = html;
    }
  </script>

  <!-- 2ë‹¨ê³„: ìœ ë¬¼ ë½‘ê¸° -->
  <h2>2ë‹¨ê³„-2: ìœ ë¬¼ ë½‘ê¸°</h2>
  <fieldset>
    <legend>ìœ ë¬¼ ì„¤ì •</legend>

    <label>
      ìµœëŒ€ ìœ ë¬¼ ê°œìˆ˜:
      <input type="number" id="maxRelics" value="5" min="1" />
    </label>
    <button onclick="decideRelicCount()">ìœ ë¬¼ ê°œìˆ˜ ë½‘ê¸°</button>
    <div id="relicCountResult" class="result-box"></div>

    <label>
      ìœ ë¬¼ í¬ê·€ë„ ë‚´ ë²ˆí˜¸ ì¤‘ë³µ í—ˆìš©:
      <input type="checkbox" id="relicNumberAllowDuplicate" checked />
    </label>

    <button onclick="drawRelics()">ìœ ë¬¼ ë„ê°ì—ì„œ ë½‘ê¸° ì‹œì‘</button>
    <div id="relicDrawResult" class="result-box"></div>
  </fieldset>

  <script>
    // í¬ê·€ë„ë³„ ìœ ë¬¼ ê°œìˆ˜
    const relicRarityCounts = {
      1: 41, // í”í•œ ìœ ë¬¼
      2: 48, // í¬ê·€í•œ ìœ ë¬¼
      3: 21, // ë³´ìŠ¤ ìœ ë¬¼
      4: 9,  // ìƒì  ìœ ë¬¼
      5: 6,  // ì‹œë‚˜ë¦¬ì˜¤ ìœ ë¬¼
      6: 48, // ë‹¤ë¥¸ ì§ì—…ì˜ ìœ ë¬¼
      7: 11  // ë¹„ë°€ ìœ ë¬¼
    };

    // í¬ê·€ë„ í…ìŠ¤íŠ¸ ë§¤í•‘
    const relicRarityNames = {
      1: 'í”í•œ ìœ ë¬¼',
      2: 'í¬ê·€í•œ ìœ ë¬¼',
      3: 'ë³´ìŠ¤ ìœ ë¬¼',
      4: 'ìƒì  ìœ ë¬¼',
      5: 'ì‹œë‚˜ë¦¬ì˜¤ ìœ ë¬¼',
      6: 'ë‹¤ë¥¸ ì§ì—…ì˜ ìœ ë¬¼',
      7: 'ë¹„ë°€ ìœ ë¬¼'
    };

    let relicCount = 0;
    let relics = []; // {rarity, index}

    function decideRelicCount() {
      const max = parseInt(document.getElementById('maxRelics').value || '1', 10);
      relicCount = randInt(1, max);
      relics = [];
      const resultEl = document.getElementById('relicCountResult');
      resultEl.innerHTML = 'ë½‘íŒ ìœ ë¬¼ ê°œìˆ˜: <span class="result-value">' + relicCount + '</span> (1~' + max + ')';
      document.getElementById('relicDrawResult').textContent = '';
    }

    function drawSingleRelic(numberAllowDup) {
      let rarity = randInt(1, 7); // 1~7 (ë¹„ë°€ ìœ ë¬¼ í¬í•¨)
      let total = relicRarityCounts[rarity] || 0;
      if (total <= 0) {
        // ë„ê°ì— ì•„ì§ ì—†ìŒ -> ë‹¤ì‹œ
        return drawSingleRelic(numberAllowDup);
      }
      let idx = randInt(1, total);

      // ì „ì²´ ìœ ë¬¼ì€ ì¤‘ë³µ ë¶ˆê°€
      const existsRelic = relics.some(r => r.rarity === rarity && r.index === idx);
      if (existsRelic) {
        // ì§ˆë¬¸ ê·œì¹™ìƒ "ìœ ë¬¼ ìì²´ ì¤‘ë³µ ë¶ˆê°€"ë¼ì„œ ë¬´ì¡°ê±´ ë‹¤ì‹œ
        return drawSingleRelic(numberAllowDup);
      }

      // í¬ê·€ë„ ë‚´ ë²ˆí˜¸ ì¤‘ë³µ í—ˆìš© ì—¬ë¶€ëŠ”, ì´ ê·œì¹™ê³¼ ì‚¬ì‹¤ìƒ ì¶©ëŒí•˜ì§€ë§Œ
      // ì§ˆë¬¸ëŒ€ë¡œë¼ë©´ "í¬ê·€ë„ëŠ” ì¤‘ë³µ ê°€ëŠ¥, ë²ˆí˜¸ ì¤‘ë³µ ì—¬ë¶€ë§Œ ì˜µì…˜"ì´ë¼
      // ë²ˆí˜¸ ì¤‘ë³µ í—ˆìš©ì´ë©´ 'ê°™ì€ í¬ê·€ë„+ë²ˆí˜¸ë¥¼ ìƒˆë¡œ ë½‘ëŠ” ê²ƒ'ì€
      // ì „ì²´ ìœ ë¬¼ ì¤‘ë³µ ê·œì¹™ ë•Œë¬¸ì— ê²°êµ­ ë‹¤ì‹œ ë½‘ê²Œ ë¨.
      // â†’ êµ¬í˜„ì€ ì´ë¯¸ existsRelic ì²´í¬ë¡œ ì²˜ë¦¬ëœ ìƒíƒœ.

      return { rarity, index: idx };
    }

    function drawRelics() {
      if (!relicCount || relicCount <= 0) {
        alert('ë¨¼ì € ìœ ë¬¼ ê°œìˆ˜ë¥¼ ë½‘ì•„ì£¼ì„¸ìš”.');
        return;
      }
      const numberAllowDup = document.getElementById('relicNumberAllowDuplicate').checked;
      relics = [];
      for (let i = 0; i < relicCount; i++) {
        const relic = drawSingleRelic(numberAllowDup);
        relics.push(relic);
      }
      renderRelics();
    }

    function redrawSingleRelic(index) {
      if (index < 0 || index >= relics.length) return;
      const numberAllowDup = document.getElementById('relicNumberAllowDuplicate').checked;
      const newRelic = drawSingleRelic(numberAllowDup);
      relics[index] = newRelic;
      renderRelics();
    }

    function renderRelics() {
      renderItems(relics, 'relicDrawResult', 'ìœ ë¬¼', relicRarityNames, 'redrawSingleRelic');
    }
  </script>

  <!-- 3ë‹¨ê³„: ì‹œë“œ ë½‘ê¸° -->
  <h2>3ë‹¨ê³„: ì‹œë“œ ë½‘ê¸° (10ìë¦¬)</h2>
  <fieldset>
    <legend>ì‹œë“œ(1~9) 10ë²ˆ ë½‘ê¸°</legend>
    <button onclick="drawSeed()">ì‹œë“œ ë½‘ê¸°</button>
    <div id="seedResult" class="result-box"></div>
  </fieldset>

  <script>
    function drawSeed() {
      let arr = [];
      for (let i = 0; i < 10; i++) {
        arr.push(randInt(1, 9));
      }
      const resultEl = document.getElementById('seedResult');
      resultEl.innerHTML = 'ì‹œë“œ ìˆ«ì 10ê°œ: <span class="result-value">' + arr.join('') + '</span><br>' +
        '(ê°œë³„ ê°’: ' + arr.map(n => '<span class="result-value">' + n + '</span>').join(', ') + ')';
    }
  </script>
    </div>
    </div>
  </div>
</body>
</html>
